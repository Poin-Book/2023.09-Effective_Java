# 네이티브 메서드는 신중히 사용하라

> 작성자 @destiny3912

## 목차
- [네이티브 메서드는 신중히 사용하라](#네이티브-메서드는-신중히-사용하라)
  - [목차](#목차)
  - [본문](#본문)
    - [1. Java Native Interface(JNI)](#1-java-native-interfacejni)
    - [2. 네이티브 메서드의 쓰임](#2-네이티브-메서드의-쓰임)
    - [3. 네이티브 메서드의 단점](#3-네이티브-메서드의-단점)
    - [4. 정리](#4-정리)
## 본문

### 1. Java Native Interface(JNI)

---

> 자바 프로그램이 네이티브 메서드를 호출하는 기술
> 
- 네이티브 메서드
    
    자바 프로그램이 C나 C++같은 네이티브 언어로 작성한 메서드
    

### 2. 네이티브 메서드의 쓰임

---

1. 플랫폼 특화 기능 사용(레지스트리)
    - 자바가 계속 발전해가면서 이러한 플랫폼 특화 기능을 흡수하고 있음
    - 예를 들어서 Process API가 추가되어서 OS 프로세스에 직접 접근이 가능해짐
        
        [Java® Platform, Standard Edition & Java Development Kit Version 21 API Specification](https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Process.html)
        
        [Guide to java.lang.Process API | Baeldung](https://www.baeldung.com/java-process-api)
        
    - 따라서 지속적으로 네이티브 메서드를 사용해야할 이유가 없어짐
2. 네이티브 코드로 작성된 기존 라이브러리 사용
    - 레거시 라이브러리
3. 성능 개선을 목적으로 사용
    - 성능에 결정적인 부분만 사용
    - 엄청 옛날이라면 이야기가 다르겠지만
    - 요즘의 JVM은 네이티브 메서드와 동급의 성능을 보여준다.
    - 예를 들어서 BigInteger 같은 경우 자바 3 부터는 순수 자바로 구현이 되어있음
    - 다만 GNU 다중 정밀 연산 라이브러리의 발전으로 고성능의 정밀한 연산이 필요하다면 저것을 사용한다.

### 3. 네이티브 메서드의 단점

---

1. Item 50에서 네이티브 언어가 안전하지 않다 라고 하였음
    - 따라서 네이티브 메서드가 있는 프로그램도 안전하지 않음 (메모리 훼손 오류)
2. 네이티브 언어는 플렛폼을 많이 타서 속도가 오히려 느려지는 경우도 있다.
    - 이식성이 낮고 디버깅도 어렵다
3. 가비지 컬랙터의 추적이 불가능 하다.
    - 따라서 메모리의 자동 회수가 불가능 하다.
4. 자바 코드와 네이티브 코드를 넘나들때 비용이 발생한다.
5. 네이티브 메서드와 자바 코드 사이에는 접착 코드를 작성해야함
    - 굉장히 복잡하고 가독성이 떨어짐

### 4. 정리

---

1. 생각보다 네이티브 메서드가 성능을 비약적으로 개선시켜주지 않는다
2. 가능한 한 최소한만 사용하고 철저한 테스트가 필요하다.
3. 작은 네이티브 코드 조각 하나가 버그를 발생시켜 프로그램 전체를 죽일 수 있다.